14/14

V prostředí Freescale Codewarrior verze 6.x vytvořte vestavnou aplikaci Čítač. Předpokládejte implementaci na mikrokontroléru (MCU) řady HCS08.

S uživatelem komunikujte pomocí prvků nástroje Visualization Tool dostupném v prostředí Freescale Codewarrior 6.x. Rozložení prvků (levý Seg7, pravý Seg7, DILSwitch) nástroje Visualization Tool máte k dipozici ke stažení ve *.vlt souboru (viz Soubory / Projekty / Citac), jejich konfigurace je ponechána na Vás.

Detaily k zadání

Vnitřní stav čítače - budiž označen symbolem CNT - nechť obsahuje (informaci o velikosti) N=16 bitů, majících význam bezznaménkové celočíselné hodnoty, tj. hodnoty z rozsahu 0 až ((2^N) - 1). Nechť stav CNT je tvořen, tj. rozložen na, N/4 půlbyty (nibble) - pro jejich označení budiž použit prefix/symbol CNTN - indexovaných od 0 (nejvýznamnější - MS, CNTN[0]) po (N/4)-1 (nejméně významný - LS, CNTN[(N/4)-1]), v rámci půlbytů nechť jsou bity indexovány od nejlevějšího 3 (MS) po nejpravější 0 (LS). Každý půlbyte nechť představuje číslici v osmičkové, "OCT", číselné soustavě (soustavě se základem 8). Pozn. ("méně formálně - táž myšlenka jinými slovy"): Konkatenace CNTN[0] až CNT[(N/4)-1] je rovna CNT.
Prvek DILswitch slouží k řízení aplikace. Je složen z celkem 8 přepínačů. Pro usnadnění popisu nechť jsou přepínače postupně očíslovány ve směru zleva doprava čísly 7, 6, 5, 4, 3, 2, 1, 0 (to např. umožní reprezentovat stav všech přepínačů prvku jednobytovou hodnotou, kde 7. resp. 0. bit je MS resp. LS bit tohoto bytu). Spodní (horní) poloha příslušného přepínače nechť umožňuje nastavit log.0 (log.1) na příslušném bitu v (Vámi zvoleném) bytu sloužícímu k uložení stavu všech přepínačů prvku DILswitch.
Požadavky na funkčnost přepínačů jsou následující: Přepínač 7 slouží k vypnutí (0) nebo zapnutí (1) aplikace, přepínač 6 slouží k volbě režimu nastavení (0) nebo čítání (1), přepínač 5 umožňuje volit směr čítání - dolů (0) nebo nahoru (1), přepínač 4 umožňuje volit mezi levým Seg7 (0) a pravým Seg7 (1), přepínače 3 až 0 slouží k volbě platné 4-bitové hodnoty (bit přepínače 3 je MS a bit přepínače 0 je LS). Polohu přepínačů je možné měnit kdykoliv za běhu aplikace,
Požadavky na funkčnost aplikace jsou následující: Režim Stop: Při DILswitch=0XXXXXXXb (tj. přepínač 7 je ve spodní poloze, stavy ostatních přepínačů jsou nepodstatné - značeno symbolem "X") přejde aplikace do počátečního stavu, který je definován takto: pořadě se zastaví čítání, vynuluje se stav čítače i 7Seg a přepínače 6 až 0 se nastaví do spodní polohy. Režim Set: Nastavení nejvyšších 4 bitů DILswitch na hodnotu 10X0 (10X1) umožní zobrazit horní (dolní) 4 bity 7Seg určující index CNTN (hodnotu právě indexovaného CNTN); změna stavu 7Seg je možná až po změně polohy alespoň jednoho z přepínačů 3 až 0, a to na hodnotu odpovídající poloze přepínačů. Režim Start: Při DILswitch=110XXXXX (111XXXXX) aplikace dekrementuje (inkrementuje) vnitřní stav čítače tak dlouho, dokud stav čítače není roven nebo menší (roven nebo větší) než konečná hodnota 0 (max. číslo na N/4 číslicích) v osmičkové číselné soustavě. Je-li, pak se nastaví vnitřní stav na konečnou hodnotu; tento stav je držen po dobu, během níž by došlo ke třem změnám vnitřního stavu, což se bude projevovat střídavým úplným zhasínáním a rozsvěcením 7Seg po každém uplynutí periody pro změnu stavu; poté aplikace přechází do počátečního stavu. Dobu, po které má dojít ke změně stavu čítače odměřujte s využitím přerušení od některého modulů dostupných na čipu HCS08 (detaily viz níže) a změnu stavu čítače provádějte v rámci příslušné obsluhy přerušení, 
Upřesnění významu a očekávaného chování 7Seg: v režimu Start levý (pravý) 7Seg zobrazuje index CNTN s nejpomaleji se měnící hodnotou (hodnotu indexovaného CNTN). V režimu Set navíc, dle nastavení přepínače 4 v poloze 0 (1), střídavě rozsvěcuje a zhasíná hodnota na levém (pravém) 7Seg s cílem vizualizovat, který ze 7Seg je aktivní a může být uživatelem (pře)nastaven. Číslice zobrazované na levém (pravém) 7Seg nechť jsou v šestnáctkové číselné soustavě (soustavě se základem 16),   
V ostatních (tj. ve výše nepopsaných) případech je chování a nastavení aplikace a prvků nedefinováno, tj. je ponecháno na úvaze řešitele/lky.
Podmínky pro implementaci aplikace jsou upřesněny dle následujícího klíče, a to takto:

Implementační jazyk je zcela ponechán na volbě studenta(ky).
Student(ka) s nejpravější dvojicí znaků v rámci svého přihlašovacího jména, chápaného pro tento účel jako textový řetězec tvořený znaky původní ASCII tabulky, v rozmezích (včetně uvedených mezí) "00" až "04" resp. "11" až "20" použije pro odměřování času Real-Time Counter (RTC) modul dostupný na čipu HCS08. 
Student(ka) s nejpravější dvojicí znaků v rámci svého přihlašovacího jména, chápaného pro tento účel jako textový řetězec tvořený znaky původní ASCII tabulky, v rozmezích (včetně uvedených mezí) "05" až "10", "21" až "zz" použije pro odměřování času Timer Pulse-Width Modulator TPM modul dostupný na čipu HCS08.   
Požadavky na dokumentaci k projektu

Max 10 stran A4, formát čitelný v prostředí CVT včetně všech zdrojových textů, obrázků, tabulek atd. (např. v případě použití (La)TEXu), písmo min. velikost 11),
Analýza paměťových nároků aplikace (zejména nároky na RAM, flash, velikost kódu, datové typy a názvy proměnných a konstant, význam jejich hodnot a bitů),
Dekomponovaný slovní popis činnosti aplikace metodou shora dolů,
grafický popis činnosti aplikace např. s využitím vývojových diagramů či stavových automatů,
Kostry/úseky významných částí kódu s komentáři.